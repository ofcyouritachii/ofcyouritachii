<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://cdn.jsdelivr.net https://cdnjs.cloudflare.com; font-src 'self' https://fonts.gstatic.com https://cdn.jsdelivr.net https://cdnjs.cloudflare.com; script-src 'self' https://cdn.jsdelivr.net 'unsafe-inline'; img-src 'self' https://cdn.discordapp.com data: https://upload.wikimedia.org; connect-src 'self' https://api.lanyard.rest ws://api.lanyard.rest wss://api.lanyard.rest; frame-src 'none'; object-src 'none';">
    <meta name="description" content="Portfolio of yokaimsi, showcasing projects, skills, and Discord presence.">
    <title>yokaimsi</title>
    <link rel="icon" href="https://upload.wikimedia.org/wikipedia/commons/d/d3/Python_icon_%28black_and_white%29.svg" type="image/svg+xml" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw==" crossorigin="anonymous" referrerpolicy="no-referrer">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/devicons/devicon@v2.15.1/devicon.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-bg: #0a0a0f;
            --secondary-bg: #1a1a2e;
            --accent-color: #00d4ff;
            --accent-secondary: #ff006e;
            --text-primary: #ffffff;
            --text-secondary: #a0a0a0;
            --glass-bg: rgba(255, 255, 255, 0.05);
            --glass-border: rgba(255, 255, 255, 0.1);
            --neon-glow: 0 0 20px rgba(0, 212, 255, 0.3);
            --success-color: #43b581;
            --warning-color: #faa61a;
            --error-color: #f04747;
            --offline-color: #747f8d;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--primary-bg);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 80%, rgba(0, 212, 255, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(255, 0, 110, 0.1) 0%, transparent 50%);
            z-index: -1;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
        }

        section {
            padding: 4rem 0;
            opacity: 0;
            transform: translateY(50px);
            transition: opacity 0.6s ease-out, transform 0.6s ease-out;
        }

        section.visible {
            opacity: 1;
            transform: translateY(0);
        }

        h1, h2, h3 {
            margin-bottom: 1rem;
        }

        h1 {
            font-size: 3rem;
            text-align: center;
        }

        h2 {
            font-size: 2.5rem;
            text-align: center;
        }

        p {
            margin-bottom: 1rem;
        }

        .hero {
            text-align: center;
            padding: 6rem 0;
        }

        .avatar {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            margin-bottom: 1rem;
            border: 3px solid var(--accent-color);
            object-fit: cover;
        }

        .username {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }

        .discriminator {
            font-size: 1.2rem;
            color: var(--text-secondary);
            margin-bottom: 1rem;
        }

        .status-indicator {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .status-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: var(--offline-color);
        }

        .status-dot.online { background: var(--success-color); }
        .status-dot.idle { background: var(--warning-color); }
        .status-dot.dnd { background: var(--error-color); }

        .status-text {
            font-size: 1rem;
        }

        .custom-status {
            font-style: italic;
            color: var(--text-secondary);
            text-align: center;
        }

        .activity-section {
            max-width: 400px;
            margin: 0 auto;
            background: var(--glass-bg);
            padding: 1rem;
            border-radius: 8px;
            border: 1px solid var(--glass-border);
        }

        .about-content {
            max-width: 800px;
            margin: 0 auto;
        }

        .social-links {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-top: 2rem;
        }

        .social-link {
            color: var(--text-primary);
            font-size: 1.5rem;
            transition: color 0.3s ease;
        }

        .social-link:hover {
            color: var(--accent-color);
        }

        .projects-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
        }

        .project-card {
            background: var(--glass-bg);
            padding: 1.5rem;
            border-radius: 8px;
            border: 1px solid var(--glass-border);
            transition: transform 0.3s ease;
        }

        .project-card:hover {
            transform: translateY(-5px);
        }

        .project-title {
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
        }

        .project-description {
            color: var(--text-secondary);
            margin-bottom: 1rem;
        }

        .project-tech {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .tech-tag {
            background: var(--secondary-bg);
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-size: 0.8rem;
        }

        .project-actions {
            display: flex;
            gap: 1rem;
        }

        .project-btn {
            text-decoration: none;
            color: var(--accent-color);
            border: 1px solid var(--accent-color);
            padding: 0.5rem 1rem;
            border-radius: 4px;
            transition: background 0.3s ease;
        }

        .project-btn:hover {
            background: var(--accent-color);
            color: var(--primary-bg);
        }

        .skills-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
        }

        .skill-card {
            background: var(--glass-bg);
            padding: 1rem;
            border-radius: 8px;
            border: 1px solid var(--glass-border);
            text-align: center;
            transition: transform 0.3s ease;
        }

        .skill-card:hover {
            transform: translateY(-5px);
        }

        .skill-card i {
            font-size: 3rem;
            margin-bottom: 0.5rem;
            color: var(--accent-color);
        }

        .skill-label {
            font-size: 1rem;
        }

        .error-details, .setup-notice {
            max-width: 400px;
            margin: 1rem auto;
            padding: 1rem;
            border-radius: 8px;
        }

        .setup-notice {
            background: rgba(255, 193, 7, 0.1);
            border: 1px solid #ffc107;
            color: #ffc107;
        }

        .error-details {
            background: rgba(240, 71, 71, 0.1);
            border: 1px solid var(--error-color);
            color: var(--error-color);
        }

        @media (max-width: 768px) {
            .hero {
                padding: 4rem 0;
            }

            .avatar {
                width: 120px;
                height: 120px;
            }

            h1 {
                font-size: 2.5rem;
            }

            h2 {
                font-size: 2rem;
            }

            .social-links {
                flex-wrap: wrap;
            }
        }
    </style>
</head>
<body>
    <main class="container">
        <section id="home" class="hero">
            <div class="loading-container" id="loading">
                <div class="spinner"></div>
                <div class="loading-text">connecting to discord...</div>
            </div>
            <div class="profile-container" id="profile" style="display: none;">
                <img src="https://cdn.discordapp.com/embed/avatars/0.png" alt="User avatar" id="avatar" class="avatar" loading="lazy">
                <div class="username" id="username">yokaimsi</div>
                <div class="discriminator" id="discriminator">@yokaimsi</div>
                <div class="status-indicator">
                    <span class="status-dot offline" id="statusDot"></span>
                    <span class="status-text" id="statusText">Offline</span>
                </div>
                <div class="custom-status" id="customStatus"></div>
                <div class="activity-section" id="activitySection" style="display: none;">
                    <div class="activity-header" id="activityHeader">
                        <i class="fas fa-spinner"></i>
                        <span id="activityHeaderText">Loading...</span>
                    </div>
                    <div class="activity-content">
                        <div class="activity-details">
                            <div class="activity-name" id="activityName"></div>
                            <div class="activity-file-info" id="activityFileInfo" style="display: none;">
                                <i class="file-type-icon" id="fileTypeIcon"></i>
                                <span class="activity-details-text" id="activityDetails"></span>
                            </div>
                            <div class="activity-details-text" id="activityDetailsNoFile"></div>
                            <div class="activity-state" id="activityState"></div>
                            <div class="activity-timestamp" id="activityTimestamp"></div>
                        </div>
                    </div>
                </div>
                <div class="setup-notice" id="setupNotice" style="display: none;">
                    <h4><i class="fas fa-exclamation-triangle"></i> Setup Required</h4>
                    <ol>
                        <li>Join the <a href="https://discord.gg/lanyard" target="_blank" rel="noopener noreferrer">Lanyard Discord Server</a>.</li>
                        <li>Enable your Discord presence in the Lanyard bot settings.</li>
                        <li>Refresh this page after setup.</li>
                    </ol>
                </div>
                <div class="error-details" id="errorDetails"></div>
            </div>
        </section>

        <section id="about">
            <h2>About Me</h2>
            <div class="about-content">
                <p>I'm yokaimsi, a passionate developer with a love for creating innovative solutions and exploring new technologies. My journey in programming started with Python, and I've since expanded my expertise to include web development, Discord bot creation, and system administration.</p>
                <p>With a strong foundation in Python, JavaScript, HTML, and CSS, I enjoy building projects that combine functionality with aesthetic design. My work focuses on creating efficient tools, engaging bots, and user-friendly web applications. I'm also proficient in various Linux distributions and version control systems like Git.</p>
                <p>When I'm not coding, you can find me tinkering with new frameworks, contributing to open-source projects, or engaging with the developer community on Discord and GitHub. I believe in continuous learning and sharing knowledge to inspire others.</p>
                <p>My goal is to create impactful solutions that make technology more accessible and enjoyable for everyone. Feel free to connect with me through my social links to collaborate or discuss exciting tech ideas!</p>
            </div>
            <div class="social-links">
                <a href="https://github.com/yokaimsi" target="_blank" rel="noopener noreferrer" class="social-link github" title="GitHub">
                    <i class="fab fa-github"></i>
                </a>
                <a href="https://instagram.com/i.g_asan" target="_blank" rel="noopener noreferrer" class="social-link instagram" title="Instagram">
                    <i class="fab fa-instagram"></i>
                </a>
                <a href="https://discord.com/users/1282292887878369358" target="_blank" rel="noopener noreferrer" class="social-link discord" title="Discord">
                    <i class="fab fa-discord"></i>
                </a>
                <a href="https://www.linkedin.com/in/mohd-aasan" target="_blank" rel="noopener noreferrer" class="social-link linkedin" title="LinkedIn">
                    <i class="fab fa-linkedin"></i>
                </a>
            </div>
        </section>

        <section id="projects">
            <h2>Projects</h2>
            <div class="projects-grid">
                <div class="project-card">
                    <h3 class="project-title">Python Tools N Toys</h3>
                    <p class="project-description">A collection of Python scripts for testing, including a string search tool with memory management.</p>
                    <div class="project-tech">
                        <span class="tech-tag">Python</span>
                    </div>
                    <div class="project-actions">
                        <a href="https://github.com/yokaimsi/Python-Tools-N-Toys" target="_blank" rel="noopener noreferrer" class="project-btn github">
                            <i class="fab fa-github"></i> GitHub
                        </a>
                    </div>
                </div>
                <div class="project-card">
                    <h3 class="project-title">ezfetch</h3>
                    <p class="project-description">A simple and efficient system information fetch tool.</p>
                    <div class="project-tech">
                        <span class="tech-tag">Python</span>
                    </div>
                    <div class="project-actions">
                        <a href="https://github.com/yokaimsi/ezfetch" target="_blank" rel="noopener noreferrer" class="project-btn github">
                            <i class="fab fa-github"></i> GitHub
                        </a>
                    </div>
                </div>
                <div class="project-card">
                    <h3 class="project-title">Bumblebee Discord Bot</h3>
                    <p class="project-description">A multifunctional Discord bot with moderation and custom commands.</p>
                    <div class="project-tech">
                        <span class="tech-tag">JS</span>
                        <span class="tech-tag">Python</span>
                    </div>
                    <div class="project-actions">
                        <a href="https://github.com/yokaimsi" target="_blank" rel="noopener noreferrer" class="project-btn github">
                            <i class="fab fa-github"></i> GitHub
                        </a>
                        <a href="https://discord.gg/GDxC4aYQxQ" target="_blank" rel="noopener noreferrer" class="project-btn discord">
                            <i class="fab fa-discord"></i> Discord Server
                        </a>
                    </div>
                </div>
                <div class="project-card">
                    <h3 class="project-title">Discord Bots</h3>
                    <p class="project-description">A repository containing various Discord bot implementations.</p>
                    <div class="project-tech">
                        <span class="tech-tag">JS</span>
                        <span class="tech-tag">Python</span>
                    </div>
                    <div class="project-actions">
                        <a href="https://github.com/yokaimsi/Discord-BOTS" target="_blank" rel="noopener noreferrer" class="project-btn github">
                            <i class="fab fa-github"></i> GitHub
                        </a>
                    </div>
                </div>
            </div>
        </section>

        <section id="skills">
            <h2>My Skills</h2>
            <div class="skills-grid">
                <div class="skill-card">
                    <i class="devicon-python-plain"></i>
                    <span class="skill-label">Python</span>
                </div>
                <div class="skill-card">
                    <i class="fab fa-html5"></i>
                    <span class="skill-label">HTML</span>
                </div>
                <div class="skill-card">
                    <i class="fab fa-css3-alt"></i>
                    <span class="skill-label">CSS</span>
                </div>
                <div class="skill-card">
                    <i class="fab fa-js-square"></i>
                    <span class="skill-label">JavaScript</span>
                </div>
                <div class="skill-card">
                    <i class="fab fa-git-alt"></i>
                    <span class="skill-label">Git</span>
                </div>
                <div class="skill-card">
                    <i class="fab fa-github"></i>
                    <span class="skill-label">GitHub</span>
                </div>
                <div class="skill-card">
                    <i class="devicon-vscode-plain"></i>
                    <span class="skill-label">VSCode</span>
                </div>
                <div class="skill-card">
                    <i class="fas fa-flask"></i>
                    <span class="skill-label">Flask</span>
                </div>
                <div class="skill-card">
                    <i class="devicon-sqlite-plain"></i>
                    <span class="skill-label">SQLite</span>
                </div>
                <div class="skill-card">
                    <i class="fas fa-cloud"></i>
                    <span class="skill-label">Vercel</span>
                </div>
                <div class="skill-card">
                    <i class="fab fa-windows"></i>
                    <span class="skill-label">Windows</span>
                </div>
                <div class="skill-card">
                    <i class="fab fa-linux"></i>
                    <span class="skill-label">Kali Linux</span>
                </div>
                <div class="skill-card">
                    <i class="fab fa-linux"></i>
                    <span class="skill-label">Linux Mint</span>
                </div>
                <div class="skill-card">
                    <i class="fab fa-linux"></i>
                    <span class="skill-label">Parrot</span>
                </div>
                <div class="skill-card">
                    <i class="fab fa-linux"></i>
                    <span class="skill-label">Ubuntu</span>
                </div>
                <div class="skill-card">
                    <i class="fab fa-linux"></i>
                    <span class="skill-label">Zorin</span>
                </div>
            </div>
        </section>
    </main>
    <script>
        const CONFIG = {
            DISCORD_USER_ID: '1282292887878369358',
            LANYARD_WS_URL: 'wss://api.lanyard.rest/socket',
            LANYARD_HTTP_URL: 'https://api.lanyard.rest/v1/users/',
            RETRY_ATTEMPTS: 3,
            RETRY_DELAY: 3000,
            REFRESH_INTERVAL: 30000,
            TIMEOUT: 15000,
            FALLBACK_AVATAR: 'https://cdn.discordapp.com/embed/avatars/0.png',
            CACHE_KEY: 'discord_status_cache',
            CACHE_EXPIRY: 30000
        };

        let retryCount = 0;
        let refreshInterval = null;
        let isConnected = false;
        let lastFetchTime = 0;
        let websocket = null;
        let wsRetryCount = 0;

        const fileTypeIcons = {
            'html': { icon: 'fab fa-html5', color: '#e34c26' },
            'css': { icon: 'fab fa-css3-alt', color: '#1572b6' },
            'js': { icon: 'fab fa-js-square', color: '#f7df1e' },
            'py': { icon: 'fab fa-python', color: '#3776ab' },
            'default': { icon: 'fas fa-file', color: '#6c757d' }
        };

        function safeImageLoad(img, src, fallback) {
            return new Promise((resolve) => {
                const tempImg = new Image();
                tempImg.onload = () => {
                    img.src = src;
                    resolve(true);
                };
                tempImg.onerror = () => {
                    img.src = fallback;
                    resolve(false);
                };
                tempImg.src = src;
            });
        }

        function formatTimestamp(timestamp) {
            if (!timestamp) return 'Just started';
            const now = Date.now();
            const elapsed = now - timestamp;
            const minutes = Math.floor(elapsed / 60000);
            const hours = Math.floor(minutes / 60);
            return hours > 0 ? `${hours}h ${minutes % 60}m elapsed` : `${minutes}m elapsed`;
        }

        function getFileTypeIcon(filename) {
            const extension = filename?.split('.').pop()?.toLowerCase() || 'default';
            return fileTypeIcons[extension] || fileTypeIcons.default;
        }

        function getCachedData() {
            const cached = localStorage.getItem(CONFIG.CACHE_KEY);
            if (!cached) return null;
            const { data, timestamp } = JSON.parse(cached);
            if (Date.now() - timestamp < CONFIG.CACHE_EXPIRY) {
                return data;
            }
            localStorage.removeItem(CONFIG.CACHE_KEY);
            return null;
        }

        function setCachedData(data) {
            localStorage.setItem(CONFIG.CACHE_KEY, JSON.stringify({
                data,
                timestamp: Date.now()
            }));
        }

        async function fetchDiscordStatusFallback() {
            const loadingContainer = document.getElementById('loading');
            const profileContainer = document.getElementById('profile');
            const errorDetails = document.getElementById('errorDetails');
            const setupNotice = document.getElementById('setupNotice');

            try {
                const cachedData = getCachedData();
                if (cachedData && Date.now() - lastFetchTime < CONFIG.REFRESH_INTERVAL) {
                    isConnected = true;
                    loadingContainer.style.display = 'none';
                    profileContainer.style.display = 'block';
                    setupNotice.style.display = 'none';
                    errorDetails.style.display = 'none';
                    updateDiscordProfile(cachedData);
                    return;
                }

                loadingContainer.style.display = 'flex';
                profileContainer.style.display = 'none';
                const controller = new AbortController();
                const timeoutId = setTimeout(() => controller.abort(), CONFIG.TIMEOUT);
                const response = await fetch(`${CONFIG.LANYARD_HTTP_URL}${CONFIG.DISCORD_USER_ID}`, {
                    signal: controller.signal,
                    headers: { 'Accept': 'application/json' }
                });
                clearTimeout(timeoutId);

                if (!response.ok) {
                    if (response.status === 404) {
                        throw new Error('User not found. Ensure the Discord user ID is registered with Lanyard.');
                    }
                    throw new Error(`HTTP error: ${response.status} ${response.statusText}`);
                }

                const data = await response.json();
                if (!data.success) {
                    throw new Error(data.error?.message || 'Unknown Lanyard API error');
                }

                isConnected = true;
                retryCount = 0;
                lastFetchTime = Date.now();
                setCachedData(data.data);
                loadingContainer.style.display = 'none';
                profileContainer.style.display = 'block';
                setupNotice.style.display = 'none';
                errorDetails.style.display = 'none';
                updateDiscordProfile(data.data);
            } catch (error) {
                retryCount++;
                let errorMessage = error.message || 'An unknown error occurred';
                if (error.name === 'AbortError') {
                    errorMessage = 'Request timed out';
                } else if (error.message.includes('Failed to fetch')) {
                    errorMessage = 'Network error: Failed to connect to Lanyard API';
                }

                if (retryCount < CONFIG.RETRY_ATTEMPTS) {
                    setTimeout(fetchDiscordStatusFallback, CONFIG.RETRY_DELAY);
                    return;
                }

                const cachedData = getCachedData();
                if (cachedData) {
                    isConnected = true;
                    loadingContainer.style.display = 'none';
                    profileContainer.style.display = 'block';
                    setupNotice.style.display = 'none';
                    errorDetails.style.display = 'none';
                    updateDiscordProfile(cachedData);
                    return;
                }

                loadingContainer.style.display = 'none';
                profileContainer.style.display = 'block';
                errorDetails.style.display = 'block';
                errorDetails.textContent = `Error: ${errorMessage}`;
                if (errorMessage.includes('User not found')) {
                    setupNotice.style.display = 'block';
                }
                showOfflineState();
            }
        }

        function initWebSocket() {
            try {
                websocket = new WebSocket(CONFIG.LANYARD_WS_URL);
                const loadingContainer = document.getElementById('loading');
                const profileContainer = document.getElementById('profile');
                const errorDetails = document.getElementById('errorDetails');
                const setupNotice = document.getElementById('setupNotice');

                websocket.onopen = () => {
                    wsRetryCount = 0;
                    isConnected = true;
                    loadingContainer.style.display = 'none';
                    profileContainer.style.display = 'block';
                    errorDetails.style.display = 'none';
                    setupNotice.style.display = 'none';
                    websocket.send(JSON.stringify({ op: 2, d: { subscribe_to_id: CONFIG.DISCORD_USER_ID } }));
                    setInterval(() => {
                        if (websocket.readyState === WebSocket.OPEN) {
                            websocket.send(JSON.stringify({ op: 3 }));
                        }
                    }, 30000);
                };

                websocket.onmessage = (event) => {
                    try {
                        const data = JSON.parse(event.data);
                        if (data.op === 0 && data.t === 'INIT_STATE' || data.t === 'PRESENCE_UPDATE') {
                            lastFetchTime = Date.now();
                            setCachedData(data.d);
                            updateDiscordProfile(data.d);
                        }
                    } catch (e) {
                        errorDetails.style.display = 'block';
                        errorDetails.textContent = 'Error: Failed to parse WebSocket data';
                    }
                };

                websocket.onerror = () => {
                    wsRetryCount++;
                    if (wsRetryCount < CONFIG.RETRY_ATTEMPTS) {
                        setTimeout(initWebSocket, CONFIG.RETRY_DELAY);
                    } else {
                        errorDetails.style.display = 'block';
                        errorDetails.textContent = 'Error: WebSocket connection failed, falling back to HTTP';
                        fetchDiscordStatusFallback();
                    }
                };

                websocket.onclose = () => {
                    wsRetryCount++;
                    if (wsRetryCount < CONFIG.RETRY_ATTEMPTS) {
                        setTimeout(initWebSocket, CONFIG.RETRY_DELAY);
                    } else {
                        errorDetails.style.display = 'block';
                        errorDetails.textContent = 'Error: WebSocket closed, falling back to HTTP';
                        fetchDiscordStatusFallback();
                    }
                };
            } catch (e) {
                document.getElementById('errorDetails').style.display = 'block';
                document.getElementById('errorDetails').textContent = 'Error: WebSocket initialization failed';
                fetchDiscordStatusFallback();
            }
        }

        function showOfflineState() {
            try {
                const avatar = document.getElementById('avatar');
                const username = document.getElementById('username');
                const discriminator = document.getElementById('discriminator');

                safeImageLoad(avatar, CONFIG.FALLBACK_AVATAR, CONFIG.FALLBACK_AVATAR).then((success) => {
                    avatar.classList.toggle('error', !success);
                });

                username.textContent = 'yokaimsi';
                discriminator.textContent = '@yokaimsi';
                avatar.alt = 'yokaimsi\'s avatar';
                updateStatus('offline');
                updateCustomStatus([]);
                updateActivities([]);
            } catch (e) {
                document.getElementById('errorDetails').style.display = 'block';
                document.getElementById('errorDetails').textContent = 'Error: Failed to display offline state';
            }
        }

        function updateDiscordProfile(userData) {
            try {
                const avatar = document.getElementById('avatar');
                const username = document.getElementById('username');
                const discriminator = document.getElementById('discriminator');
                const avatarUrl = userData.discord_user?.avatar 
                    ? `https://cdn.discordapp.com/avatars/${CONFIG.DISCORD_USER_ID}/${userData.discord_user.avatar}.png?size=128`
                    : CONFIG.FALLBACK_AVATAR;

                safeImageLoad(avatar, avatarUrl, CONFIG.FALLBACK_AVATAR).then((success) => {
                    avatar.classList.toggle('error', !success);
                });

                username.textContent = userData.discord_user?.username || 'yokaimsi';
                discriminator.textContent = `@${userData.discord_user?.username || 'yokaimsi'}`;
                avatar.alt = `${userData.discord_user?.username || 'yokaimsi'}'s avatar`;

                updateStatus(userData.discord_status || 'offline');
                updateCustomStatus(userData.activities || []);
                updateActivities(userData.activities || []);
            } catch (e) {
                document.getElementById('errorDetails').style.display = 'block';
                document.getElementById('errorDetails').textContent = 'Error: Failed to update profile';
                showOfflineState();
            }
        }

        function updateStatus(status) {
            try {
                const statusDot = document.getElementById('statusDot');
                const statusText = document.getElementById('statusText');
                if (statusDot && statusText) {
                    statusDot.classList.remove('online', 'idle', 'dnd', 'offline');
                    switch (status) {
                        case 'online':
                            statusText.textContent = 'Online';
                            statusDot.classList.add('online');
                            break;
                        case 'idle':
                            statusText.textContent = 'Away';
                            statusDot.classList.add('idle');
                            break;
                        case 'dnd':
                            statusText.textContent = 'Do Not Disturb';
                            statusDot.classList.add('dnd');
                            break;
                        default:
                            statusText.textContent = 'Offline';
                            statusDot.classList.add('offline');
                            break;
                    }
                }
            } catch (e) {
                document.getElementById('errorDetails').style.display = 'block';
                document.getElementById('errorDetails').textContent = 'Error: Failed to update status';
            }
        }

        function updateCustomStatus(activities) {
            try {
                const customStatus = document.getElementById('customStatus');
                if (customStatus) {
                    const customActivity = activities.find(activity => activity.type === 4 && activity.state);
                    if (customActivity && customActivity.state) {
                        customStatus.textContent = customActivity.state;
                        customStatus.style.display = 'block';
                    } else {
                        customStatus.style.display = 'none';
                    }
                }
            } catch (e) {
                document.getElementById('errorDetails').style.display = 'block';
                document.getElementById('errorDetails').textContent = 'Error: Failed to update custom status';
            }
        }

        function updateActivities(activities) {
            try {
                const activitySection = document.getElementById('activitySection');
                const activityHeader = document.getElementById('activityHeader');
                const activityHeaderText = document.getElementById('activityHeaderText');
                const activityName = document.getElementById('activityName');
                const activityFileInfo = document.getElementById('activityFileInfo');
                const fileTypeIcon = document.getElementById('fileTypeIcon');
                const activityDetails = document.getElementById('activityDetails');
                const activityDetailsNoFile = document.getElementById('activityDetailsNoFile');
                const activityState = document.getElementById('activityState');
                const activityTimestamp = document.getElementById('activityTimestamp');

                if (!activitySection) return;

                const priorityActivity = activities.find(activity => activity.type === 0 || activity.type === 2);

                if (!priorityActivity) {
                    activitySection.style.display = 'none';
                    return;
                }

                activitySection.style.display = 'block';

                if (priorityActivity.type === 2) {
                    activityHeaderText.textContent = 'Listening to Spotify';
                    activityHeader.querySelector('i').className = 'fab fa-spotify';
                    activityName.textContent = priorityActivity.details || 'Unknown Track';
                    activityDetailsNoFile.textContent = `by ${priorityActivity.state || 'Unknown Artist'}`;
                    activityState.textContent = `on ${priorityActivity.assets?.large_text || 'Spotify'}`;
                    activityFileInfo.style.display = 'none';
                    activityTimestamp.textContent = priorityActivity.timestamps?.start 
                        ? formatTimestamp(priorityActivity.timestamps.start) 
                        : 'Just started';
                } else if (priorityActivity.type === 0) {
                    activityHeaderText.textContent = priorityActivity.assets?.large_text || 'Current Activity';
                    activityHeader.querySelector('i').className = 'fas fa-gamepad';
                    activityName.textContent = priorityActivity.name || 'Unknown Activity';

                    const fileExtension = priorityActivity.details?.split('.').pop()?.toLowerCase();
                    if (fileExtension && fileTypeIcons[fileExtension]) {
                        const fileIcon = getFileTypeIcon(priorityActivity.details);
                        fileTypeIcon.className = fileIcon.icon;
                        fileTypeIcon.style.color = fileIcon.color;
                        activityDetails.textContent = priorityActivity.details || '';
                        activityFileInfo.style.display = 'flex';
                        activityDetailsNoFile.textContent = '';
                    } else {
                        activityFileInfo.style.display = 'none';
                        activityDetailsNoFile.textContent = priorityActivity.details || '';
                    }

                    activityState.textContent = priorityActivity.state || '';
                    activityTimestamp.textContent = priorityActivity.timestamps?.start 
                        ? formatTimestamp(priorityActivity.timestamps.start) 
                        : 'Just started';
                }
            } catch (e) {
                document.getElementById('errorDetails').style.display = 'block';
                document.getElementById('errorDetails').textContent = 'Error: Failed to update activities';
            }
        }

        function startStatusRefresh() {
            if (refreshInterval) {
                clearInterval(refreshInterval);
            }
            refreshInterval = setInterval(() => {
                if (!isConnected || websocket?.readyState !== WebSocket.OPEN) {
                    fetchDiscordStatusFallback();
                }
            }, CONFIG.REFRESH_INTERVAL);
        }

        function observeSections() {
            const sections = document.querySelectorAll('section');
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('visible');
                        observer.unobserve(entry.target);
                    }
                });
            }, { threshold: 0.1 });

            sections.forEach(section => observer.observe(section));
        }

        document.addEventListener('DOMContentLoaded', () => {
            observeSections();
            initWebSocket();
            startStatusRefresh();
        });

        window.addEventListener('beforeunload', () => {
            if (websocket) {
                websocket.close();
            }
            if (refreshInterval) {
                clearInterval(refreshInterval);
            }
        });
    </script>
</body>
</html>